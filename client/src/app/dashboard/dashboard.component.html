 <div class="container">
  <div class="dashboard">
    <div class="dashboard__section dashboard__user">
      <div class="dashboard__user__content">
        <img [src]="user.picture" alt="{{user.first_name}} {{user.last_name}}">
        <h3 class="dashboard__user__content__name"><span>{{user.first_name}} {{user.last_name}}</span></h3>
        <p class="dashboard__user__content__role">{{user.role}}</p>
        <p class="dashboard__user__content__email">{{user.email}}</p>
      </div>
    </div>
    <div class="dashboard__section dashboard__pick">
      <ul class="dashboard__pick__list" *ngIf="user.coursesEnrolledIn?.length > 0">
        <li class="dashboard__pick__list-item" *ngFor="let course of user.coursesEnrolledIn; let courseIndex = index"
          [ngStyle]="{'flex': activeCoursePicked === courseIndex ? '1' : 'unset'}" [style.background-image]="'url(' + course.course.image + ')'">
          <div class="dashboard__pick__list-item__content">
            <h3 class="dashboard__pick__list-item__heading">{{course.course.title}}</h3>
            <p class="dashboard__pick__list-item__complete-percentage">{{percentCompleted}}% COMPLETE</p>
          </div>
        </li>
      </ul>
      <i *ngIf="user.coursesEnrolledIn?.length > 0" class="fa fa-angle-left dashboard__pick__list__arrow-previous" (click)="previousCoursePicked()"></i>
      <i *ngIf="user.coursesEnrolledIn?.length > 0" class="fa fa-angle-right dashboard__pick__list__arrow-next" (click)="nextCoursePicked()"></i>
      <ul *ngIf="user.coursesEnrolledIn?.length < 1" class="dashboard__pick__list">
        <p class="no-content text-center">
          <i class="fa fa-frown-o"></i>
          No courses yet
        </p>
      </ul>
    </div>
    <div class="dashboard__section dashboard__list">
      <ul class="dashboard__list--modules">
        <li [ngClass]="{'active': activeModule === moduleIndex}"
          *ngFor="let module of user.coursesEnrolledIn[activeCoursePicked]?.course?.modules; let moduleIndex = index">
          <div (click)="changeActiveModulePicked(moduleIndex)" class="dashboard__list__item__header flex flex--between">
            <span>
              <i
                *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex > moduleIndex ||
                user.coursesEnrolledIn[activeCoursePicked]?.finished"
                class="fa fa-check"
              ></i>
              <i
                *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex === moduleIndex &&
                !user.coursesEnrolledIn[activeCoursePicked]?.finished"
                class="fa fa-book"
              ></i>
              {{ module.title }}
            </span>
            <i [ngClass]="{'fa-angle-left': activeModule === moduleIndex, 'fa-angle-down': activeModule !== moduleIndex}"
                  class="fa"></i>
          </div>
          <div *ngIf="activeModule === moduleIndex" class="dashboard__list__item-content">
            <div class="dashboard__list__module-content">
                <h4>{{ module.title }}</h4>
                <p>{{ module.description }}</p>
                <div class="flex flex--end">
                  <button
                    class="button button--small margin-right"
                    (click)="skipModule()"
                    *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex === moduleIndex &&
                    !user.coursesEnrolledIn[activeCoursePicked]?.finished"
                    [disabled]="!module.skippable"
                  >{{module.skippable ? 'Skip module' : 'Not Skippable'}}</button>
                </div>
            </div>
            <ul class="dashboard__list dashboard__list--lectures">
              <li [ngClass]="{'active': activeLecture === lectureIndex}"
                *ngFor="let lecture of user.coursesEnrolledIn[activeCoursePicked]?.course?.modules[activeModule]?.lectures; let lectureIndex = index">
                <div (click)="changeActiveLecturePicked(lectureIndex)"
                  class="dashboard__list--lectures__item__header flex flex--between">
                  <span>
                    <i
                      *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex > moduleIndex ||
                      (user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex === moduleIndex &&
                      user.coursesEnrolledIn[activeCoursePicked]?.currentLectureIndex > lectureIndex) ||
                      user.coursesEnrolledIn[activeCoursePicked]?.finished"
                      class="fa fa-check"
                    ></i>
                    <i
                      *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex === moduleIndex &&
                      user.coursesEnrolledIn[activeCoursePicked]?.currentLectureIndex === lectureIndex &&
                      !user.coursesEnrolledIn[activeCoursePicked]?.finished"
                      class="fa fa-book"
                    ></i>
                    {{ lecture.title }}
                  </span>
                  <i [ngClass]="{'fa-angle-left': activeLecture === lectureIndex, 'fa-angle-down': activeLecture !== lectureIndex}"
                    class="fa"></i>
                </div>
                <div *ngIf="activeLecture === lectureIndex" class="dashboard__list__item-content">
                  <div class="dashboard__list__module-content">
                      <h4>{{ lecture.title }}</h4>
                      <p>{{ lecture.description }}</p>
                      <div class="flex flex--end">
                        <button
                          class="button button--small margin-right"
                          (click)="skipLecture()"
                          *ngIf="(user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex === moduleIndex &&
                          user.coursesEnrolledIn[activeCoursePicked]?.currentLectureIndex === lectureIndex) &&
                          !user.coursesEnrolledIn[activeCoursePicked]?.finished"
                          [disabled]="!lecture.skippable"
                        >{{lecture.skippable ? 'Skip lecture' : 'Not Skippable'}}</button>
                        <button
                          class="button button--small"
                          [routerLink]="['/lecture', lecture.slug]"
                          *ngIf="(user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex > moduleIndex ||
                          (user.coursesEnrolledIn[activeCoursePicked]?.currentModuleIndex >= moduleIndex &&
                          user.coursesEnrolledIn[activeCoursePicked]?.currentLectureIndex >= lectureIndex)) ||
                          user.coursesEnrolledIn[activeCoursePicked]?.finished"
                        >View lecture</button>
                      </div>
                  </div>
                </div>
              </li>
              <p *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.course?.modules[activeModule]?.lectures.length < 1"
                class="no-content text-center"><i class="fa fa-frown-o"></i>No lectures yet</p>
            </ul>
          </div>
        </li>
        <p *ngIf="user.coursesEnrolledIn[activeCoursePicked]?.course?.modules.length < 1" class="no-content text-center"><i class="fa fa-frown-o"></i>No modules yet</p>
      </ul>
    </div>
  </div>
</div>